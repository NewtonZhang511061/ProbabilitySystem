# ProbabilitySystem
基於TDD實作SlotGame

## 如何開始第一個TDD測項
選擇最**簡單**也最**常見**的場景\
***輸!***\
當玩家拍下Spin按鈕, 莊家當然希望你輸, 不然就不用賺錢了
贏的場景千變萬化, 但輸只有一種

```
Kent Beck: 不要完全不規劃, 但也不要規劃
```

***重點是要足夠「快點」開始***\
一但開始之後, 只要不斷小步伐快跑測試所「框」出來的邊界, 隨著功能越多, 事情會逐漸明朗下去

## 用「最小」努力通過測試!

不要做超過測試範圍的事情\
當工作的context(邊界)範圍越小, 越容易進入心流, 也越不容易發散\
人在大範圍工作中持續切換, 所消耗的成本是很高的\
這也是為甚麼TDD在敏捷中是非常重要的基本設施\
也因為TDD測項的每個PASS都會讓人產生多巴胺(期待 → 行動 → 立即正回饋), 所以才有辦法持續維持開發的高效率

```
沒有紅燈過的測試你該害怕, 紅燈不要停太久, 趕緊綠燈開始衝刺
```

## 用其他簡單的場景逼出I/O

**重點數字: 2**

***輸***的場景已經被我們完成了, 接下來開始考慮***贏***的部分\
因為不管是IfElse或是SwitchCase只需要考慮***兩個***不一樣的可能就足以逼出I/O\
一個已經被我們完成了, 也就是輸的情境, 還剩下另外一個\
那很明朗了, 新增一個簡單場景即可!
- 打中第一排連線, 獲得20Bet

```
Fake It Until You Make It
```

## 在模具中開始煎蛋

由於已經有一個測試進行保護, 所以我們可以開始安全的進行現實場景實現\
但是切記 ***腳步要小要快***

替 <打中第一排連線, 獲得20Bet> 的測項進行轉大人, 加入滾輪!\
但是先不要讓他轉, 因為我們的目的並不是讓他轉而是看到PASS

```
TDD就像早餐店模具, 我們要煎出漂亮的蛋, 快速又漂亮
```

## 重構

- 避免Primitive Obsession
建立Reels物件
```
Martin Fowler: 請不要試圖猜想
```
- 避免Feature Envy\
將邏輯封裝在Reels\
海勒姆定律
```
不要在我的地盤搞事
```
- 使用工廠取得物\
例如:
> 取得持久化資料 : Restore()\
> 轉化物件: to(), from()\
> ...更多
```
Vaughn Vernon: 使用Constructor取得物件將會降低對模型的表達性
```

## 接下來很舒服了
繼續後面測項\
有了擊中第一排, 我們還需要贏得第二三排\
很好!果不其然的紅燈了\
趕快!綠燈吧
```csharp
public int Spin(int betLine)
{
    if (_reels.IsHitRow(betLine) && betLine == 1) return 20;
    if (_reels.IsHitRow(betLine) && betLine == 2) return 20;
    if (_reels.IsHitRow(betLine) && betLine == 3) return 20;
    return 0;
}
```
就這樣?!\
沒錯就這樣, 來看看是不是綠燈了吧\
***PASS***\
因為我們我們做了***重構***\
快步重構(不要超出測試邊界)的重要性, 在這個例子中就看出來了
```
Kent Beck: Make the change easy, them make the easy change
```








